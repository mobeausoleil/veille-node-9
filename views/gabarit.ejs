<!DOCTYPE html>
<html lang="fr">
<meta charset="utf-8">
<%- include('composants/head') %>
<body>
<%- include('composants/menu') %>
<div id="global">
	<nav>
		<ul>
			<li><a href="http://localhost:8081/peupler"><%= __("peupler") %></a></li>
			<li><a href="http://localhost:8081/vider"><%= __("vider") %></a></li>
		</ul>
	</nav>
 <table class="tableau">
 	<% let noLigne = 0 %>
	 <% for (elm of adresses) { %>

	 <% if(noLigne == 0){ %>
		 <tr>
			 <% noLigne++
			 for (p in elm ){ %>
				 <% if(p == "nom" || p == "prenom") { %>
				 <th><a href='http://localhost:8081/trier/<%= p %>/<%= direction %>'><%= __(p) %></a></th>
				 <% } %>
			 <% } %>
		 </tr>
	 <% } %>

	 <tr>
		 <% for (p in elm ){ %>
		 	<% if(p == "nom" || p == "prenom") { %>
		 	<td><%= elm[p] %></td>
		 	<% } %>
		 <% } %>
		 <td><a class="btnSup" href='/detruire/<%= elm._id %>'><%= __("detruire") %></a></td>
		 <td><a href="/profilmembre/<%= elm._id %>"><%= __("profil") %></a></td>
	 </tr>
	 <% } %>
 </table>
 <%- include('composants/formulaire_ajout') %>
</div>
<%- include('composants/footer') %>

<script type="text/javascript">

	/////////////////////////////////////////////////DÃ©truire

	let elmSup = document.querySelectorAll('.btnSup');
	for (elm of elmSup){
		elm.addEventListener('click', function(){

			xhr = new XMLHttpRequest();
			xhr.open('POST', "/ajax_modifier", true);

			let laLigne = this.parentNode.parentNode;
			let id = laLigne.children[0].innerHTML;
			let nom = laLigne.children[1].innerHTML;
			let prenom = laLigne.children[2].innerHTML;
			let telephone = laLigne.children[3].innerHTML;
			let courriel = laLigne.children[4].innerHTML;

			data = {
				"_id" : id
			}

			console.log(data);
			sData = JSON.stringify(data);
			xhr.setRequestHeader('Content-type', 'application/json');
			xhr.send(sData);
			xhr.addEventListener("readystatechange", traiterRequest, false);
		})
	}

	function traiterRequest(e){
		if(xhr.readyState == 4 && xhr.status == 200) {
			let maReponse = JSON.parse(xhr.responseText);
		}
	}

</script>
</body>
</html>